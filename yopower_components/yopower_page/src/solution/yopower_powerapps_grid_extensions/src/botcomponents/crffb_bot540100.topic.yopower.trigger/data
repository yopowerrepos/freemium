kind: AdaptiveDialog
beginDialog:
  kind: OnEventActivity
  id: main
  eventName: yopower.trigger
  actions:
    - kind: ParseValue
      id: xgVM7l
      displayName: Parse Page Context
      variable: Topic.PageContext
      valueType:
        kind: Record
        properties:
          pageContext:
            type:
              kind: Record
              properties:
                entityTypeName: String
                id:
                  type:
                    kind: Record
                    properties:
                      guid: String

                pageName: String
                pageType: String
                viewId:
                  type:
                    kind: Record
                    properties:
                      guid: String

                viewType: Number

      value: =If(!IsBlank(System.Activity.ChannelData.SetModelPageContext), System.Activity.ChannelData.SetModelPageContext, System.Activity.Value)

    - kind: ParseValue
      id: VUJCdj
      variable: Topic.CustomParameters
      valueType: String
      value: =JSON(System.Activity.Value)

    - kind: SendActivity
      id: sendActivity_djHqEU
      displayName: Event Parameters
      activity:
        text:
          - "{Topic.CustomParameters}"
        attachments:
          - kind: AdaptiveCardTemplate
            cardContent: |-
              ={
                  type: "AdaptiveCard",
                  speak: "3 minute energy flow with kayo video",
                  '$schema': "https://adaptivecards.io/schemas/adaptive-card.json",
                  version: "1.5",
                                  body: [
                      {
                          type: "Image",
                          url: "https://raw.githubusercontent.com/OfficeDev/Microsoft-Teams-Card-Samples/main/samples/author-highlight-video/assets/video_image.png",
                          altText: "Those parameters came from Model-Driven and were intercepted by Copilot's Topic",
                          style: "RoundedCorners"
                      },
                      {
                          type: "TextBlock",
                          text: "Those parameters came from Model-Driven and were intercepted by Copilot's Topic",
                          wrap: true,
                          size: "Large",
                          weight: "Bolder"
                      },
                      {
                          type: "ColumnSet",
                          columns: [
                              {
                                  type: "Column",
                                  width: "auto",
                                  items: [
                                      {
                                          type: "Image",
                                          url: "https://raw.githubusercontent.com/OfficeDev/Microsoft-Teams-Card-Samples/main/samples/author-highlight-video/assets/avatar.png",
                                          width: "24px",
                                          height: "24px",
                                          style: "Person",
                                          altText: "Avatar of Kayo Miwa"
                                      }
                                  ],
                                  verticalContentAlignment: "Center"
                              },
                              {
                                  type: "Column",
                                  width: "stretch",
                                  items: [
                                      {
                                          type: "TextBlock",
                                          text: "Vinicius Basile variant from Universe C-137 ",
                                          wrap: true
                                      }
                                  ],
                                  spacing: "Small",
                                  verticalContentAlignment: "Center"
                              }
                          ]
                      },
                      {
                          type: "TextBlock",
                          text: Topic.CustomParameters,
                          wrap: true
                      },
                              {
                          type: "TextBlock",
                          text: Topic.PageContext.pageContext.entityTypeName,
                          wrap: true
                      },
                              {
                          type: "TextBlock",
                          text: Topic.PageContext.pageContext.id.guid,
                          wrap: true
                      },
                                      {
                          type: "TextBlock",
                          text: Topic.PageContext.pageContext.pageName,
                          wrap: true
                      },
                                      {
                          type: "TextBlock",
                          text: Topic.PageContext.pageContext.pageType,
                          wrap: true
                      },
                      {
                          type: "ActionSet",
                          actions: [
                              {
                                  type: "Action.OpenUrl",
                                  title: "Open",
                                  url: "https://adaptivecards.io/"
                              },
                              {
                                  type: "Action.OpenUrl",
                                  title: "Remind me",
                                  url: "https://adaptivecards.io/",
                                  iconUrl: "icon:AlertUrgent"
                              }
                          ]
                      }
                  ]
              }

inputType: {}
outputType:
  properties:
    PageContext:
      displayName: PageContext
      type:
        kind: Record